# 系统设计：内容分发网络（CDN）

了解CDN解决的问题。

让我们从一个问题开始：如果全球数百万用户使用我们的数据密集型应用程序，而我们的服务仅在一个数据中心部署以响应用户的请求，可能会出现什么问题呢？

可能出现以下问题：

- **高延迟**：由于与提供服务的数据中心的物理距离，用户感知的延迟将很高。用户感知的延迟有许多组成部分，例如传输延迟（可用带宽的函数）、传播延迟（距离的函数）、排队延迟（网络拥塞的函数）和节点处理延迟。因此，数据传输距离长导致延迟更高。实时应用程序通常需要低于200毫秒（ms）的延迟。对于互联网电话（VoIP），延迟不应超过150毫秒，而视频流应用程序无法容忍超过几秒钟的延迟。> **注：**根据2021年12月21日所做的一项调查，美国东部（弗吉尼亚北部）到美国西部（加利福尼亚北部）的平均延迟为62.9毫秒。跨越大陆，例如从美国东部（弗吉尼亚北部）到非洲（开普敦），则为225.63毫秒。这是双向延迟，也称为往返延迟。

  ![QQ截图20230408183638](/img/11-Content Delivery Network (CDN)/QQ截图20230408183638.png)

  全球范围内的源数据中心提供用户请求

- **数据密集型应用程序**：数据密集型应用程序需要传输大量流量。在较长的距离上，这可能是一个问题，因为网络路径会穿过不同类型的ISP。由于某些较小的路径消息传输单元（MTU）链接，应用程序的吞吐量可能会降低。同样，网络路径的不同部分可能具有不同的拥塞特性。随着用户数量的增加，问题将倍增，因为当多个客户端请求时，源服务器将不得不为每个用户单独提供数据，也就是说，主数据中心将需要发送大量冗余数据。但是，使用流媒体服务的应用程序具有数据密集型和动态特性。> **注：**根据一项调查，78%的美国消费者使用流媒体服务，这是五年内增加了25%。

- **数据中心资源的稀缺性**：当服务的用户数量显著增加时，重要的数据中心资源，例如计算能力和带宽，将成为限制。同时同时服务数百万用户需要进行扩展。即使在单个数据中心中实现了扩展，当数据中心由于自然灾害或与互联网连接的问题而下线时，仍可能出现单个故障点。

  ![QQ截图20230408183646](/img/11-Content Delivery Network (CDN)/QQ截图20230408183646.png)

  Facebook和YouTube应用程序的用户增长

  > **注：** 根据一项研究，YouTube、Netflix和亚马逊Prime在2020年共产生了80%的互联网流量。 2016年左右，CDN提供商Akamai为Web流量的15％至30％提供服务（约30TB / s）。对于90％的互联网用户，Akamai只需一跳即可到达。因此，我们有充分的理由在不使互联网核心成为瓶颈的情况下优化此数据的传递和消费。

## 我们将如何设计CDN？

我们将CDN的设计分为六个部分：

1. **[CDN简介](https://www.educative.io/collection/page/10370001/4941429335392256/5560114131501056)**：我们将提供对CDN的全面介绍，并确定功能和非功能要求。
2. **[CDN的设计](https://www.educative.io/collection/page/10370001/4941429335392256/5883973992972288)**：我们将解释如何设计CDN。我们还将简要介绍API设计。3. **[CDN深入探究：第1部分](https://www.educative.io/collection/page/10370001/4941429335392256/5267936226312192)**：本课程将讲解缓存策略和CDN架构，并讨论查找最近代理服务器的各种方法。

4. **[CDN深入探究：第2部分](https://www.educative.io/collection/page/10370001/4941429335392256/5382114350727168)**：我们将讨论如何在CDN中保持内容的一致性以及代理服务器的部署。我们还将详细介绍自定义和专业CDN。

5. **[CDN评估](https://www.educative.io/pageeditor/10370001/4941429335392256/5971383947624448)**：本课程将对我们提出的设计进行评估。

6. **[CDN系统设计测验](https://www.educative.io/collection/page/10370001/4941429335392256/6624605451583488)**：我们将通过测验加深对CDN设计的主要概念的理解。

让我们在下一课中思考解决讨论的问题的解决方案。